{"ast":null,"code":"import _defineProperty from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/toan/Downloads/GITHUB/phimmoi/node_modules/@babel/runtime/helpers/esm/inherits\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{Component}from'react';import{API_URL,API_KEY,IMAGE_BASE_URL,POSTER_SIZE,BACKDROP_SIZE}from'../../config';import HeroImage from'../elements/HeroImage/HeroImage';import SearchBar from'../elements/SearchBar/SearchBar';import FourColGrid from'../elements/FourColGrid/FourColGrid';import MovieThumb from'../elements/MovieThumb/MovieThumb';import LoadMoreBtn from'../elements/LoadMoreBtn/LoadMoreBtn';import Spinner from'../elements/Spinner/Spinner';import'./Home.css';var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);function Home(){var _getPrototypeOf2;var _this;_classCallCheck(this,Home);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Home)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={movies:[],heroImage:null,loading:false,currentPage:0,totalPages:0,searchTerm:''};_this.searchItems=function(searchTerm){var endpoint='';_this.setState({movies:[],loading:true,searchTerm:searchTerm});if(searchTerm===\"\"){endpoint=\"\".concat(API_URL,\"movie/popular?api_key=\").concat(API_KEY,\"&language=vi-VN&page=1\");}else{endpoint=\"\".concat(API_URL,\"search/movie?api_key=\").concat(API_KEY,\"&language=vi-VN&query=\").concat(searchTerm);}_this.fetchItems(endpoint);};_this.loadMoreItems=function(){var _this$state=_this.state,searchTerm=_this$state.searchTerm,currentPage=_this$state.currentPage;var endpoint='';_this.setState({loading:true});if(searchTerm===''){endpoint=\"\".concat(API_URL,\"movie/popular?api_key=\").concat(API_KEY,\"&language=vi-VN&page=\").concat(currentPage+1);}else{endpoint=\"\".concat(API_URL,\"search/movie?api_key=\").concat(API_KEY,\"&language=vi-VN&query=\").concat(searchTerm,\"&page=\").concat(currentPage+1);}_this.fetchItems(endpoint);};_this.fetchItems=function(endpoint){var _this$state2=_this.state,movies=_this$state2.movies,heroImage=_this$state2.heroImage,searchTerm=_this$state2.searchTerm;fetch(endpoint).then(function(result){return result.json();}).then(function(result){_this.setState({movies:[].concat(_toConsumableArray(movies),_toConsumableArray(result.results)),heroImage:heroImage||result.results[0],loading:false,currentPage:result.page,totalPages:result.total_pages},function(){// Remember state for the next mount if we´re not in a search view\nif(searchTerm===\"\"){sessionStorage.setItem('HomeState',JSON.stringify(_this.state));}});}).catch(function(error){return console.error('Error:',error);});};return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){if(sessionStorage.getItem('HomeState')){var state=JSON.parse(sessionStorage.getItem('HomeState'));this.setState(_objectSpread({},state));}else{this.setState({loading:true});var endpoint=\"\".concat(API_URL,\"movie/popular?api_key=\").concat(API_KEY,\"&language=vi-VN&page=1\");this.fetchItems(endpoint);}}},{key:\"render\",value:function render(){var _this$state3=this.state,movies=_this$state3.movies,heroImage=_this$state3.heroImage,loading=_this$state3.loading,currentPage=_this$state3.currentPage,totalPages=_this$state3.totalPages,searchTerm=_this$state3.searchTerm;return React.createElement(\"div\",{className:\"rmdb-home\"},heroImage?React.createElement(\"div\",null,React.createElement(HeroImage,{image:\"\".concat(IMAGE_BASE_URL).concat(BACKDROP_SIZE).concat(heroImage.backdrop_path),title:heroImage.original_title,text:heroImage.overview}),React.createElement(SearchBar,{callback:this.searchItems})):null,React.createElement(\"div\",{className:\"rmdb-home-grid\"},React.createElement(FourColGrid,{header:searchTerm?'Search Result':'Popular Movies',loading:loading},movies.map(function(element,i){return React.createElement(MovieThumb,{key:i,clickable:true,image:element.poster_path?\"\".concat(IMAGE_BASE_URL).concat(POSTER_SIZE).concat(element.poster_path):'./images/no_image.jpg',movieId:element.id,movieName:element.original_title});})),loading?React.createElement(Spinner,null):null,currentPage<=totalPages&&!loading?React.createElement(LoadMoreBtn,{text:\"Load More\",onClick:this.loadMoreItems}):null));}}]);return Home;}(Component);export default Home;","map":{"version":3,"sources":["/Users/toan/Downloads/GITHUB/phimmoi/src/components/Home/Home.js"],"names":["React","Component","API_URL","API_KEY","IMAGE_BASE_URL","POSTER_SIZE","BACKDROP_SIZE","HeroImage","SearchBar","FourColGrid","MovieThumb","LoadMoreBtn","Spinner","Home","state","movies","heroImage","loading","currentPage","totalPages","searchTerm","searchItems","endpoint","setState","fetchItems","loadMoreItems","fetch","then","result","json","results","page","total_pages","sessionStorage","setItem","JSON","stringify","catch","error","console","getItem","parse","backdrop_path","original_title","overview","map","element","i","poster_path","id"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { API_URL, API_KEY, IMAGE_BASE_URL, POSTER_SIZE, BACKDROP_SIZE } from '../../config';\nimport HeroImage from '../elements/HeroImage/HeroImage';\nimport SearchBar from '../elements/SearchBar/SearchBar';\nimport FourColGrid from '../elements/FourColGrid/FourColGrid';\nimport MovieThumb from '../elements/MovieThumb/MovieThumb';\nimport LoadMoreBtn from '../elements/LoadMoreBtn/LoadMoreBtn';\nimport Spinner from '../elements/Spinner/Spinner';\nimport './Home.css';\n\nclass Home extends Component {\n  state = {\n    movies: [],\n    heroImage: null,\n    loading: false,\n    currentPage: 0,\n    totalPages: 0,\n    searchTerm: ''\n  }\n\n  componentDidMount() {\n    if (sessionStorage.getItem('HomeState')) {\n      let state = JSON.parse(sessionStorage.getItem('HomeState'))\n      this.setState({ ...state })\n    } else {\n      this.setState({ loading: true })\n      const endpoint = `${API_URL}movie/popular?api_key=${API_KEY}&language=vi-VN&page=1`;\n      this.fetchItems(endpoint);\n    }\n  }\n \n  searchItems = (searchTerm) => {\n    let endpoint = '';\n    this.setState({\n      movies: [],\n      loading: true,\n      searchTerm\n    })\n\n    if (searchTerm === \"\") {\n      endpoint = `${API_URL}movie/popular?api_key=${API_KEY}&language=vi-VN&page=1`;\n    } else {\n      endpoint = `${API_URL}search/movie?api_key=${API_KEY}&language=vi-VN&query=${searchTerm}`;\n    }\n    this.fetchItems(endpoint);\n  }\n\n  loadMoreItems = () => {\n    const { searchTerm, currentPage } = this.state;\n\n    let endpoint = '';\n    this.setState({ loading: true })\n\n    if (searchTerm === '') {\n      endpoint = `${API_URL}movie/popular?api_key=${API_KEY}&language=vi-VN&page=${currentPage + 1}`;\n    } else {\n      endpoint = `${API_URL}search/movie?api_key=${API_KEY}&language=vi-VN&query=${searchTerm}&page=${currentPage + 1}`;\n    }\n    this.fetchItems(endpoint);\n  }\n\n  fetchItems = (endpoint) => {\n    const { movies, heroImage, searchTerm } = this.state;\n\n    fetch(endpoint)\n    .then(result => result.json())\n    .then(result => {\n      this.setState({\n        movies: [...movies, ...result.results],\n        heroImage: heroImage || result.results[0],\n        loading: false,\n        currentPage: result.page,\n        totalPages: result.total_pages\n      }, () => {\n        // Remember state for the next mount if we´re not in a search view\n        if (searchTerm === \"\") {\n          sessionStorage.setItem('HomeState', JSON.stringify(this.state));\n        }\n      })\n    })\n    .catch(error => console.error('Error:', error))\n  }\n\n  render() {\n  \n    const { movies, heroImage, loading, currentPage, totalPages, searchTerm } = this.state;\n\n    return (\n      <div className=\"rmdb-home\">\n        {heroImage ?\n          <div>\n            <HeroImage\n              image={`${IMAGE_BASE_URL}${BACKDROP_SIZE}${heroImage.backdrop_path}`}\n              title={heroImage.original_title}\n              text={heroImage.overview}\n            />\n            <SearchBar callback={this.searchItems}/>\n          </div> : null }\n          <div className=\"rmdb-home-grid\">\n            <FourColGrid\n              header={searchTerm ? 'Search Result' : 'Popular Movies'}\n              loading={loading}\n            >\n              {movies.map( (element, i) => (\n                <MovieThumb\n                  key={i}\n                  clickable={true}\n                  image={element.poster_path ? `${IMAGE_BASE_URL}${POSTER_SIZE}${element.poster_path}` : './images/no_image.jpg'}\n                  movieId={element.id}\n                  movieName={element.original_title}\n                />\n              ))}\n            </FourColGrid>\n            {loading ? <Spinner /> : null}\n            {(currentPage <= totalPages && !loading) ?\n              <LoadMoreBtn text=\"Load More\" onClick={this.loadMoreItems} />\n              : null\n            }\n          </div>\n      </div>\n    )\n  }\n}\n\nexport default Home;"]},"metadata":{},"sourceType":"module"}